---
title: Test Integration Services (TIS) Installation Checklist
permalink: "/deployment/checklist/tis.html"
layout: "document"
categories: ["deployment", "checklist"]
---

## Overview

| Item | Description |
|:-----|:------------|
| Purpose | LDAP server for TDS user accounts |
| Communicates With | OpenAM, ART |
| Repository Location | [https://bitbucket.org/sbacoss/testintegrationsystem_release](https://bitbucket.org/sbacoss/testintegrationsystem_release) |
| Additional Documentation | [TIS REST API](https://bitbucket.org/sbacoss/testintegrationsystem_release/src/a4efcfaad21c7dd154b8ab04bf452e0899c9aa13/TISServices/Documentation/TIS%20REST%20API.txt?at=default&fileviewer=file-view-default) |

## Instructions

### Create AWS Instance
* Create server instance to host Test Itegration Services (TIS) components
  * AWS instance must be at least a **t2.small**
  * Select an image with the **Windows Server 2012 R2 Base**{: style="color: #04384e"} 64-bit operating system
* Create an AWS security group with the following ports for inbound TCP traffic (can be done during instance creation):
  * 1433
  * 80
  * 3389
  * 443

### Configure Windows AWS Instance
{% include checklist/windows_server_config.md %}

## Deploy the TDS Receiver

### Build the TDS Receiver
* Clone the TIS repository to a machine that can build .NET applications:
  * `hg clone https://`[*your BitBucket user or team name*{: style="color: #f00;"}]`/sbacoss/testintegrationsystem_release`
  * Example:
    * `hg clone https://`<span class="placeholder-example">jjohnson-fw@bitbucket.org</span>`/sbacoss/testintegrationsystem_release`
* Launch Visual Studio
* Open the `TISServices/TISServices/TISServices.sln`
* In Visual Studio, right-click on the Solution and choose **Publish...**
  * **TODO: Screenshots?**{: style="background-color: #ff0;"}
  * Choose **Custom** profile
  * Choose a **local** web server
  * Provide a path to where the build results should be deployed
  * When satisifed with all settings, click **Publish**

### Deploy the TDS Receiver
* Connect to the AWS Windows server via RDP
* Create a directory where the TDS Receiver component will be deployed
  * The TDS Receiver is a web application, thus must be accessible by IIS
  * Example:  `C:\inetpub\`<span class="placeholder-example">tds_receiver</span>
* From the machine where the TDS Receiver was built, copy the *entire contents* of the directory where the **Publish** wiszard deployed the component into the directory created in the previous step.

### Configure a TDS Receiver Website in IIS
* Launch the **Internet Information Services Manager**
  * Click **Start** button in lower-left corner (leftmost control on toolbar)
  * Click the down arrow (if the **Internet Information Services Manager** does not appear)
  * Search for and launch the **Internet Information Services Manager**
* Right click on the **Default Web Site**
  * Choose **Manage Website...**
  * Choose **Stop**
* Right click on **Sites** and choose **Add Website...**

![Add website within IIS](/res/images/checklist/iis_01_add_site.png){: width="100%"}

* Provide the following details in the dialog that appears:
  * Site name: [*Choose a meaningful name*{: style="color: #f00;"}]
  * Application Pool: [**OPTIONAL:** *Choose an exisitng Application Pool, or allow IIS to create a new Application Pool for this site (**recommended**)*{: style="color: #f00;"}]
  * Physical Path: [*The path to where the TDS Receiver components have been deployed*{: style="color: #f00;"}]
  * Binding:  [*Choose an available port*{: stlye="color: #f00;"}]
  * Host name:  [**OPTIONAL:** *Provide a host name*{: style="color: #f00;"}]

* Screenshot showing example values for the TDS Receiver website:

![Add website details](/res/images/checklist/iis_02_site_details.png){: width="100%"}

### Configure the TDS Receiver Application
* Edit the [*Path\to\TDS Receiver*{: stlye="color: #f00;"}]`web.config` file
  * Example:  Edit the <span class="placeholder-example">C:\inetpub\tdsreceiver</span>`\web.config` file
* Update the following configuration:
  * `WebService name="OpenAM"`:  `https://`[*FQDN or IP address of OpenAM server*{: style="color: #f00;"}]`/auth/oauth2/tokeninfo`
  * `connectionStrings TDSQC`:  [*Connecion information to communicate with the MSSQL Server that supports the TDS Receiver*{: style="color: #f00;"}]
    * `Data Source=` [*The FQDN or IP address of the MSSQL Server that supports the TDS Receiver*{: style="color: #f00;"}]
    * `Initial Catalog=` [*The name of the database that supports the TDS Receiver*{: style="color: #f00;"}]
    * `User id=` [*The user account that has read/write access to the database that supports the TDS Receiver*{: style="color: #f00;"}]
    * `Password=` [*The password for the user account configured in the **User id** section of the connection string*{: style="color: #f00;"}]
* `LogFilePath value=`  [*The path and file name to where the TDS Receiver should write log entries*{: style="color: #f00;"}]

* Example of the configured `web.config` sections:

<div class="highlighter-rouge">
<pre class="highlight">
<code>
  &lt;WebServiceSettings&gt;
    &lt;WebService name="OpenAM" url="https://<span class="placeholder-example">sso-dev.sbtds.org</span>/auth/oauth2/tokeninfo" /&gt;
  &lt;/WebServiceSettings&gt;

  &lt;connectionStrings&gt;
    &lt;add name="TDSQC" connectionString="Data Source=<span class="placeholder-example">tis-deployment.cugsexobhx8t.us-west-2.rds.amazonaws.com</span>;Initial Catalog=<span class="placeholder-example">OSS_TIS</span>;User id=<span class="placeholder-example">remoteuser</span>;Password=<span class="placeholder-example">change*me</span>" providerName="System.Data.SqlClient" /&gt;
  &lt;/connectionStrings&gt;

  &lt;appSettings&gt;
    &lt;add key="LogFilePath" value="<span class="placeholder-example">C:\inetpub\logs\TISServicesLog.txt</span>"/&gt;
    &lt;add key="AuthTokenCache:MaxSize" value="100"/&gt;
    &lt;add key="AuthTokenCache:PurgeCount" value="9"/&gt;
    &lt;add key="AuthTokenCache:SlidingExpirationMinutes" value="240"/&gt;
  &lt;/appSettings&gt;
</code>
</pre>
</div>

### Configure IIS Permissions for the Log Directory
* Launch the **File Explorer**
* Navigate to the directory where the TDS Receiver is configured to write log entires
  * Refer to the `LogFilePath value` in the `web.config`
  * Example: <span class="placeholder-example">C:\inetpub\logs</span>
* Right-click on the directory and choose **Properties**
* Click on the **Security** tab

![Edit log file directory security](/res/images/checklist/file_explorer_01_security_tab.png){: width="100%"}

* Click the **Edit** button
* Click the **Add...** button
* Enter **IIS_IUSRS** in the **Enter object names to select** field and click **Check Names**
  * The **IIS_IUSRS** should be updated to include the server name, indicating the user group was found.
* An example of the result after the **Check Names** button is clicked:

![Add IIS_IUSRS](/res/images/checklist/file_explorer_02_check_names.png){: width="100%"}

* Click **OK**
* Give the **IIS_IUSRS** **Write** permission to the log directory:
  * Scroll down in the list of available permissions
  * Check the box next to **Write**
* An example of granting **Write** permission to the **IIS_IUSRS** group:

![Add IIS_IUSRS](/res/images/checklist/file_explorer_03_add_write_perms.png){: width="100%"}

* Click **OK**
* Click **OK**

[back to Deployment Checklists](index.html)